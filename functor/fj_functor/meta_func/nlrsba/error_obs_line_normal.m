function error_obs = error_obs_line_normal(d_x,d_y,d_z,fx,fy,orth1,orth2,orth3,orth4,rx,ry,rz,tx,ty,tz,u0,u_obs,v0,v_obs,w_x,w_y,w_z)

t2 = cos(orth1);
t3 = cos(orth2);
t4 = cos(orth3);
t5 = cos(orth4);
t6 = sin(orth1);
t7 = sin(orth2);
t8 = sin(orth3);
t9 = sin(orth4);
t10 = rx.^2;
t11 = ry.^2;
t12 = rz.^2;
t13 = 1.0./fx;
t14 = 1.0./fy;
t16 = -u_obs;
t17 = -v_obs;
t15 = t14.^2;
t18 = t2.*t4;
t19 = t2.*t8;
t20 = t4.*t6;
t21 = t6.*t8;
t22 = t16+u0;
t23 = t17+v0;
t24 = t10+t11;
t25 = t10+t12;
t26 = t11+t12;
t32 = d_x.*t3.*t8.*t9;
t33 = d_y.*t3.*t8.*t9;
t34 = d_z.*t3.*t8.*t9;
t35 = t3.*t8.*t9.*tx;
t36 = t3.*t8.*t9.*ty;
t37 = t3.*t8.*t9.*tz;
t27 = t7.*t21;
t28 = t7.*t18;
t29 = t7.*t19;
t30 = t7.*t20;
t31 = t23.^2;
t41 = -t35;
t42 = t12+t24;
t38 = -t27;
t39 = -t28;
t43 = 1.0./t42;
t44 = t19+t30;
t45 = t20+t29;
t46 = sqrt(t42);
t47 = 1.0./t46;
t48 = t18+t38;
t49 = t21+t39;
t50 = cos(t46);
t51 = sin(t46);
t52 = d_x.*t9.*t45;
t53 = d_y.*t9.*t45;
t54 = d_z.*t9.*t45;
t55 = t9.*t45.*tx;
t56 = t9.*t45.*ty;
t57 = t9.*t45.*tz;
t58 = t50-1.0;
t59 = d_x.*t9.*t48;
t60 = d_y.*t9.*t48;
t61 = -t53;
t62 = d_z.*t9.*t48;
t63 = t9.*t48.*tx;
t64 = -t55;
t65 = t9.*t48.*ty;
t66 = t9.*t48.*tz;
t69 = rx.*t47.*t51;
t70 = ry.*t47.*t51;
t71 = rz.*t47.*t51;
t67 = -t59;
t68 = -t66;
t72 = rx.*ry.*t43.*t58;
t73 = rx.*rz.*t43.*t58;
t74 = ry.*rz.*t43.*t58;
t78 = t24.*t43.*t58;
t79 = t25.*t43.*t58;
t80 = t26.*t43.*t58;
t75 = -t72;
t76 = -t73;
t77 = -t74;
t81 = t78+1.0;
t82 = t79+1.0;
t83 = t80+1.0;
t104 = t69+t74;
t105 = t70+t73;
t106 = t71+t72;
t84 = t81.*w_x;
t85 = t81.*w_y;
t86 = t82.*w_x;
t87 = t82.*w_z;
t88 = t83.*w_y;
t89 = t83.*w_z;
t93 = t3.*t4.*t5.*t81;
t94 = t3.*t4.*t5.*t82;
t95 = t3.*t8.*t9.*t83;
t96 = t5.*t44.*t81;
t97 = t5.*t44.*t83;
t98 = t9.*t45.*t81;
t100 = t5.*t49.*t82;
t101 = t5.*t49.*t83;
t102 = t9.*t48.*t82;
t107 = t104.*w_x;
t108 = t105.*w_x;
t109 = t105.*w_y;
t110 = t106.*w_y;
t111 = t104.*w_z;
t112 = t106.*w_z;
t113 = t69+t77;
t114 = t70+t76;
t115 = t71+t75;
t122 = t3.*t4.*t5.*t104;
t123 = t3.*t4.*t5.*t106;
t124 = t3.*t8.*t9.*t105;
t129 = t5.*t44.*t104;
t130 = t5.*t44.*t105;
t131 = t9.*t45.*t104;
t134 = t5.*t49.*t105;
t135 = t5.*t49.*t106;
t137 = t9.*t48.*t106;
t99 = -t96;
t103 = -t102;
t116 = t113.*w_x;
t117 = t115.*w_x;
t118 = t113.*w_y;
t119 = t114.*w_y;
t120 = t114.*w_z;
t121 = t115.*w_z;
t125 = t3.*t4.*t5.*t113;
t126 = t3.*t4.*t5.*t114;
t127 = t3.*t8.*t9.*t115;
t132 = t5.*t44.*t114;
t133 = t5.*t44.*t115;
t136 = t9.*t45.*t114;
t138 = t5.*t49.*t113;
t139 = t5.*t49.*t115;
t141 = t9.*t48.*t113;
t143 = t85+t111;
t144 = t86+t110;
t145 = t89+t108;
t178 = t64+t97+t123;
t179 = t36+t100+t129;
t181 = t68+t93+t134;
t128 = -t126;
t140 = -t133;
t142 = -t136;
t149 = t3.*t4.*t5.*t143;
t150 = t3.*t4.*t5.*t144;
t151 = t3.*t8.*t9.*t145;
t153 = -t3.*t4.*t5.*(t87-t118);
t155 = t3.*t4.*t5.*(t84-t120);
t156 = t5.*t44.*t143;
t157 = t5.*t44.*t145;
t158 = t9.*t45.*t143;
t160 = t5.*t49.*t144;
t161 = t5.*t49.*t145;
t162 = t9.*t48.*t144;
t168 = -t5.*t49.*(t88-t117);
t169 = t5.*t44.*(t88-t117);
t170 = t9.*t45.*(t84-t120);
t171 = -t9.*t48.*(t87-t118);
t172 = t107+t119;
t173 = t112+t116;
t174 = t109+t121;
t182 = t37+t99+t138;
t190 = t57+t125+t130;
t191 = t41+t132+t135;
t192 = t65+t122+t139;
t193 = t81.*t178;
t194 = t82.*t181;
t195 = t98+t124+t141;
t198 = t103+t127+t131;
t175 = t3.*t8.*t9.*t174;
t176 = t3.*t4.*t5.*t172;
t177 = t3.*t4.*t5.*t173;
t180 = t56+t94+t140;
t183 = t63+t101+t128;
t184 = t5.*t44.*t172;
t185 = t5.*t44.*t174;
t186 = t9.*t45.*t172;
t187 = t5.*t49.*t173;
t188 = t5.*t49.*t174;
t189 = t9.*t48.*t173;
t196 = d_y.*t195;
t197 = t195.*ty;
t199 = t95+t137+t142;
t202 = t115.*t182;
t204 = t104.*t190;
t205 = t105.*t191;
t206 = t145.*t182;
t208 = t54+t150+t169;
t210 = t60+t155+t161;
t211 = t172.*t178;
t215 = t173.*t181;
t216 = t190.*(t84-t120);
t219 = -t191.*(t88-t117);
t225 = -t105.*(-t32+t156+t5.*t49.*(t87-t118));
t233 = (t88-t117).*(-t32+t156+t5.*t49.*(t87-t118));
t200 = d_z.*t199;
t201 = t199.*tz;
t203 = t113.*t183;
t207 = t144.*t183;
t213 = t61+t157+t177;
t214 = t34+t160+t184;
t217 = t52+t153+t185;
t218 = -t215;
t220 = t67+t149+t188;
t221 = t62+t168+t176;
t224 = t104.*t208;
t232 = t208.*(t84-t120);
t235 = t158+t171+t175;
t239 = t151+t170+t189;
t244 = d_y.*(t162-t186+t3.*t8.*t9.*(t88-t117));
t245 = ty.*(t162-t186+t3.*t8.*t9.*(t88-t117));
t223 = t81.*t217;
t226 = t82.*t221;
t228 = t115.*t214;
t229 = t113.*t220;
t234 = t145.*t214;
t236 = t144.*t220;
t237 = d_z.*t235;
t238 = t235.*tz;
t246 = t172.*t217;
t247 = t173.*t221;
t227 = -t226;
t230 = -t229;
t242 = -t238;
t248 = t233+t236+t237+t246;
t249 = t232+t234+t244+t247;
t250 = t196+t206+t216+t218+t224+t227+t228+t245;
et1 = 1.0./sqrt((t194+t197+t202+t204-t14.*t23.*t250+t15.*t31.*t249).^2+(t193-t201-t203+t205+t14.*t23.*(t200+t207+t211+t219+t223+t225+t230+t242)+t15.*t31.*t248).^2);
et2 = -t83.*t179+t114.*t180-t106.*t192+t198.*tx+t13.*t22.*(t194+t197+t202+t204)+t14.^3.*t23.^3.*t248+t15.*t31.*(t200+t207+t211+t219+t223+t225+t230+t242+d_x.*t239-t143.*t213+t174.*(t33-t187+t5.*t44.*(t84-t120))-t210.*(t87-t118))+t14.*t23.*(t193-t201-t203+t205-d_x.*t198+t106.*t210-t143.*t180+t114.*t213-t174.*t179-t239.*tx+t83.*(t33-t187+t5.*t44.*(t84-t120))+t192.*(t87-t118))-t13.*t14.*t22.*t23.*t250+t13.*t15.*t22.*t31.*t249;
error_obs = et1.*et2;
end
