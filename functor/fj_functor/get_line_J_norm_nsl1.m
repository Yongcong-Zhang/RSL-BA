function [J_l, J_s] = get_line_J_norm_nsl1(u, v ,l, R, T, w, d, n, a, line_orth, s1, s2)
%fx = K(1,1);fy = K(2,2);ux = K(1,3); uy = K(2,3);
r11 = R(1,1); r12= R(1,2); r13= R(1,3); r21= R(2,1); r22= R(2,2); r23= R(2,3); r31= R(3,1); r32= R(3,2); r33 = R(3,3);
tx = T(1); ty = T(2); tz = T(3);
w_x = w(1);w_y = w(2);w_z = w(3);
d_x = d(1);d_y = d(2);d_z = d(3);
w1 = w_x; w2 = w_y; w3 = w_z;
d1 = d_x; d2 = d_y; d3 = d_z;
t1 = tx; t2 = ty; t3 = tz;
orth1 = line_orth(1); orth2 = line_orth(2); orth3 = line_orth(3); orth4 = line_orth(4);
I = eye(3);




l1 = l(1);l2 = l(2);l3 = l(3);l4 = l(4);l5 = l(5);l6 = l(6);l7 = l(7);l8 = l(8);l9 = l(9);
J1_1 = (v^2*(l1*v^2 + l3*v + l6)*(l9 + v*(l6 + l7) + l8*u + v^2*(l3 + l4) + l1*v^3 + l2*u*v^2 + l5*u*v))/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(3/2) - v^3/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(1/2);
J1_2 = (v^2*(l2*v^2 + l5*v + l8)*(l9 + v*(l6 + l7) + l8*u + v^2*(l3 + l4) + l1*v^3 + l2*u*v^2 + l5*u*v))/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(3/2) - (u*v^2)/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(1/2);
J1_3 = (v*(l1*v^2 + l3*v + l6)*(l9 + v*(l6 + l7) + l8*u + v^2*(l3 + l4) + l1*v^3 + l2*u*v^2 + l5*u*v))/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(3/2) - v^2/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(1/2);
J1_4 = -v^2/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(1/2);
J1_5 = (v*(l2*v^2 + l5*v + l8)*(l9 + v*(l6 + l7) + l8*u + v^2*(l3 + l4) + l1*v^3 + l2*u*v^2 + l5*u*v))/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(3/2) - (u*v)/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(1/2);
J1_6 = ((2*l1*v^2 + 2*l3*v + 2*l6)*(l9 + v*(l6 + l7) + l8*u + v^2*(l3 + l4) + l1*v^3 + l2*u*v^2 + l5*u*v))/(2*((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(3/2)) - v/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(1/2);
J1_7 = -v/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(1/2);
J1_8 = ((2*l2*v^2 + 2*l5*v + 2*l8)*(l9 + v*(l6 + l7) + l8*u + v^2*(l3 + l4) + l1*v^3 + l2*u*v^2 + l5*u*v))/(2*((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(3/2)) - u/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(1/2);
J1_9 = -1/((l1*v^2 + l3*v + l6)^2 + (l2*v^2 + l5*v + l8)^2)^(1/2);
J1_l = [J1_1, J1_2, J1_3, J1_4, J1_5, J1_6, J1_7, J1_8, J1_9];



% J1_s = [                                                                                                                                                                                                                                                                                                                                                                                                                   -((abs((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))*((6*v^2*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l2*v^2 + l5*v + l8)^2)/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^3 - (6*v^2*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/abs(l2*v^2 + l5*v + l8)^2))/(2*(abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(3/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)) + (sign((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))*((3*s1*v^2)/(l2*v^2 + l5*v + l8) - (3*s2*v^2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2))/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(1/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)))/(1 - abs((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))^2/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)*(abs(s1)^2 + abs(s2)^2)))^(1/2)
%     -(((s2*v^2)/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v) - (s1*v^2*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8)^2 + (2*s1*u*v)/(l2*v^2 + l5*v + l8) - (2*s2*u*v*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(1/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)) + (((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))*((2*v^2*sign(l2*v^2 + l5*v + l8)*abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)/abs(l2*v^2 + l5*v + l8)^3 - (2*v^2*abs(l2*v^2 + l5*v + l8)*sign(l2*v^2 + l5*v + l8))/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2 + (4*u*v*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l2*v^2 + l5*v + l8)^2)/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^3 - (4*u*v*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/abs(l2*v^2 + l5*v + l8)^2))/(2*(abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(3/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)))/(1 - ((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))^2/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)*(abs(s1)^2 + abs(s2)^2)))^(1/2)
%     -(((2*s1*v)/(l2*v^2 + l5*v + l8) - (2*s2*v*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(1/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)) - (((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))*((4*v*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/abs(l2*v^2 + l5*v + l8)^2 - (4*v*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l2*v^2 + l5*v + l8)^2)/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^3))/(2*(abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(3/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)))/(1 - ((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))^2/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)*(abs(s1)^2 + abs(s2)^2)))^(1/2)
%     -(((2*s1*v)/(l2*v^2 + l5*v + l8) - (2*s2*v*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(1/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)) - (((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))*((4*v*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/abs(l2*v^2 + l5*v + l8)^2 - (4*v*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l2*v^2 + l5*v + l8)^2)/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^3))/(2*(abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(3/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)))/(1 - ((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))^2/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)*(abs(s1)^2 + abs(s2)^2)))^(1/2)
%     -(((s2*v)/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v) + (s1*u)/(l2*v^2 + l5*v + l8) - (s2*u*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2 - (s1*v*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8)^2)/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(1/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)) - (((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))*((2*u*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/abs(l2*v^2 + l5*v + l8)^2 + (2*v*abs(l2*v^2 + l5*v + l8)*sign(l2*v^2 + l5*v + l8))/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2 - (2*u*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l2*v^2 + l5*v + l8)^2)/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^3 - (2*v*sign(l2*v^2 + l5*v + l8)*abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)/abs(l2*v^2 + l5*v + l8)^3))/(2*(abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(3/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)))/(1 - ((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))^2/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)*(abs(s1)^2 + abs(s2)^2)))^(1/2)
%     -((s1/(l2*v^2 + l5*v + l8) - (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(1/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)) + (((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))*((2*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l2*v^2 + l5*v + l8)^2)/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^3 - (2*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/abs(l2*v^2 + l5*v + l8)^2))/(2*(abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(3/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)))/(1 - ((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))^2/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)*(abs(s1)^2 + abs(s2)^2)))^(1/2)
%     -((s1/(l2*v^2 + l5*v + l8) - (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(1/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)) + (((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))*((2*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l2*v^2 + l5*v + l8)^2)/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^3 - (2*sign(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)*abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/abs(l2*v^2 + l5*v + l8)^2))/(2*(abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(3/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)))/(1 - ((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))^2/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)*(abs(s1)^2 + abs(s2)^2)))^(1/2)
%     -((s2/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v) - (s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8)^2)/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(1/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)) + (((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))*((2*sign(l2*v^2 + l5*v + l8)*abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)/abs(l2*v^2 + l5*v + l8)^3 - (2*abs(l2*v^2 + l5*v + l8)*sign(l2*v^2 + l5*v + l8))/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2))/(2*(abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)^(3/2)*(abs(s1)^2 + abs(s2)^2)^(1/2)))/(1 - ((s1*(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))/(l2*v^2 + l5*v + l8) + (s2*(l2*v^2 + l5*v + l8))/(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v))^2/((abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2/abs(l2*v^2 + l5*v + l8)^2 + abs(l2*v^2 + l5*v + l8)^2/abs(l6 + l7 + l5*u + 3*l1*v^2 + v*(2*l3 + 2*l4) + 2*l2*u*v)^2)*(abs(s1)^2 + abs(s2)^2)))^(1/2)
%     0];
% J_normal_coordinate = abc(l1,l2,l3,l4,l5,l6,l7,l8,s1,s2,u,v);
%J1_s = J1_s';




t2_new = abs(s1);
t3_new = abs(s2);
t4 = l5.*u;
t5 = l5.*v;
t6 = l3.*2.0;
t7 = l4.*2.0;
t8 = v.^2;
t12 = l2.*u.*v.*2.0;
t9 = t2_new.^2;
t10 = t3_new.^2;
t11 = l2.*t8;
t13 = l1.*t8.*3.0;
t14 = t6+t7;
t15 = t9+t10;
t16 = t14.*v;
t17 = l8+t5+t11;
t18 = abs(t17);
t19 = sign(t17);
t20 = 1.0./t15;
t21 = 1.0./t17;
t24 = 1.0./sqrt(t15);
t29 = l6+l7+t4+t12+t13+t16;
t22 = t21.^2;
t23 = t18.^2;
t26 = 1.0./t18.^3;
t27 = s1.*t21;
t30 = sign(t29);
t31 = abs(t29);
t33 = 1.0./t29;
t25 = 1.0./t23;
t28 = t27.*v.*2.0;
t32 = t31.^2;
t34 = t33.^2;
t36 = 1.0./t31.^3;
t37 = t27.*t29;
t38 = s2.*t17.*t33;
t35 = 1.0./t32;
t39 = s2.*t17.*t34;
t42 = t25.*t32;
t47 = t25.*t30.*t31.*2.0;
t48 = t25.*t30.*t31.*v.*4.0;
t50 = t23.*t30.*t36.*2.0;
t51 = t23.*t30.*t36.*v.*4.0;
t53 = t37+t38;
t40 = -t39;
t41 = t39.*v.*2.0;
t43 = t23.*t35;
t52 = -t51;
t54 = t53.^2;
t44 = -t41;
t45 = t27+t40;
t55 = t42+t43;
t60 = t48+t52;
t46 = t28+t44;
t56 = 1.0./t55;
t57 = 1.0./sqrt(t55);
t58 = t57.^3;
t61 = t24.*t45.*t57;
t62 = t24.*t46.*t57;
t63 = t20.*t54.*t56;
t64 = -t63;
t67 = t24.*t53.*t58.*(t47-t50).*(-1.0./2.0);
t68 = (t24.*t53.*t58.*t60)./2.0;
t65 = t64+1.000000000001;
t69 = -t68;
t70 = t61+t67;
t66 = 1.0./sqrt(t65);
t71 = t62+t69;
t72 = t66.*t70;
t74 = t66.*t71;
t73 = -t72;
t75 = -t74;
mt1 = [-t66.*(t24.*t57.*(t8.*t27.*3.0-t8.*t39.*3.0)-(t24.*t53.*t58.*(t8.*t25.*t30.*t31.*6.0-t8.*t23.*t30.*t36.*6.0))./2.0),-t66.*(t24.*t57.*(t28.*u+s2.*t8.*t33-t39.*u.*v.*2.0-s1.*t8.*t22.*t29)-(t24.*t53.*t58.*(t48.*u+t8.*t18.*t19.*t35.*2.0-t8.*t19.*t26.*t32.*2.0-t23.*t30.*t36.*u.*v.*4.0))./2.0),t75,t75,-t66.*(t24.*t57.*(t27.*u+t40.*u+s2.*t33.*v-s1.*t22.*t29.*v)-(t24.*t53.*t58.*(t47.*u-t23.*t30.*t36.*u.*2.0+t18.*t19.*t35.*v.*2.0-t19.*t26.*t32.*v.*2.0))./2.0),t73,t73];
mt2 = [-t66.*(t24.*t57.*(s2.*t33-s1.*t22.*t29)-(t24.*t53.*t58.*(t18.*t19.*t35.*2.0-t19.*t26.*t32.*2.0))./2.0),0.0];
J1_s = [mt1,mt2];
J1_s = real(J1_s);








dl1 = [
    0;
    0;
    0;
    r21*(cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r32*w_y - r22*w_z) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r33*w_y - r23*w_z) + d_x*cos(orth2)*sin(orth3)*sin(orth4)) - r22*(d_x*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_y - r21*w_z) - cos(orth2)*cos(orth3)*cos(orth4)*(r33*w_y - r23*w_z)) - r23*(d_x*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_y - r21*w_z) + cos(orth2)*cos(orth3)*cos(orth4)*(r32*w_y - r22*w_z));
    (r31*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r32*cos(orth2)*cos(orth3)*cos(orth4))*(r23*w_x - r13*w_y) - (r31*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r33*cos(orth2)*cos(orth3)*cos(orth4))*(r22*w_x - r12*w_y) + r13*(d_x*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_y - r21*w_z) + cos(orth2)*cos(orth3)*cos(orth4)*(r32*w_y - r22*w_z)) + r12*(d_x*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_y - r21*w_z) - cos(orth2)*cos(orth3)*cos(orth4)*(r33*w_y - r23*w_z)) - r11*(cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r32*w_y - r22*w_z) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r33*w_y - r23*w_z) + d_x*cos(orth2)*sin(orth3)*sin(orth4)) + d_z*(r32*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r33*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r31*cos(orth2)*sin(orth3)*sin(orth4)) + (r32*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r33*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)))*(r21*w_x - r11*w_y);
    (r21*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r23*cos(orth2)*cos(orth3)*cos(orth4))*(r22*w_x - r12*w_y) - (r21*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r22*cos(orth2)*cos(orth3)*cos(orth4))*(r23*w_x - r13*w_y) - d_z*(r22*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r23*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r21*cos(orth2)*sin(orth3)*sin(orth4)) - (r22*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r23*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)))*(r21*w_x - r11*w_y);
    cos(orth2)*sin(orth3)*sin(orth4)*(r21*w_x - r11*w_y) - sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r23*w_x - r13*w_y) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r22*w_x - r12*w_y);
    0;
    sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_y - r22*w_z) + sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_y - r23*w_z) - cos(orth2)*sin(orth3)*sin(orth4)*(r31*w_y - r21*w_z);
    (d_x*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_y - r21*w_z))*(r22*w_x - r12*w_y) - (d_x*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_y - r21*w_z))*(r23*w_x - r13*w_y) - d_z*(sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r32*w_y - r22*w_z) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r33*w_y - r23*w_z)) + (cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r32*w_y - r22*w_z) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r33*w_y - r23*w_z))*(r21*w_x - r11*w_y);
    (r22*w_x - r12*w_y)*(d_x*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4) - cos(orth3)*cos(orth4)*sin(orth2)*(r33*w_y - r23*w_z) + cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r31*w_y - r21*w_z)) - (r21*w_x - r11*w_y)*(d_x*sin(orth2)*sin(orth3)*sin(orth4) + cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r32*w_y - r22*w_z) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r33*w_y - r23*w_z)) + (r23*w_x - r13*w_y)*(cos(orth3)*cos(orth4)*sin(orth2)*(r32*w_y - r22*w_z) - d_x*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r31*w_y - r21*w_z)) + d_z*(sin(orth2)*sin(orth3)*sin(orth4)*(r31*w_y - r21*w_z) + cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4)*(r33*w_y - r23*w_z) - cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)*(r32*w_y - r22*w_z));
    (r21*w_x - r11*w_y)*(cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r32*w_y - r22*w_z) - cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r33*w_y - r23*w_z) + d_x*cos(orth2)*cos(orth3)*sin(orth4)) - (r22*w_x - r12*w_y)*(cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r31*w_y - r21*w_z) - d_x*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + cos(orth2)*cos(orth4)*sin(orth3)*(r33*w_y - r23*w_z)) + (r23*w_x - r13*w_y)*(d_x*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r31*w_y - r21*w_z) + cos(orth2)*cos(orth4)*sin(orth3)*(r32*w_y - r22*w_z)) - d_z*(sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r32*w_y - r22*w_z) + sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r33*w_y - r23*w_z) + cos(orth2)*cos(orth3)*sin(orth4)*(r31*w_y - r21*w_z));
    d_z*(cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_y - r22*w_z) + cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_y - r23*w_z) - cos(orth2)*cos(orth4)*sin(orth3)*(r31*w_y - r21*w_z)) - (r23*w_x - r13*w_y)*(d_x*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_y - r21*w_z) - cos(orth2)*cos(orth3)*sin(orth4)*(r32*w_y - r22*w_z)) - (r22*w_x - r12*w_y)*(d_x*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_y - r21*w_z) + cos(orth2)*cos(orth3)*sin(orth4)*(r33*w_y - r23*w_z)) + (r21*w_x - r11*w_y)*(sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r33*w_y - r23*w_z) - sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r32*w_y - r22*w_z) + d_x*cos(orth2)*cos(orth4)*sin(orth3))];
dl2 = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0;
    0;
    0;
    (r21*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r23*cos(orth2)*cos(orth3)*cos(orth4))*(r32*w_x - r12*w_z) - (r21*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r22*cos(orth2)*cos(orth3)*cos(orth4))*(r33*w_x - r13*w_z) + r33*(d_z*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r21*w_x - r11*w_y) + cos(orth2)*cos(orth3)*cos(orth4)*(r22*w_x - r12*w_y)) + r32*(d_z*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r21*w_x - r11*w_y) - cos(orth2)*cos(orth3)*cos(orth4)*(r23*w_x - r13*w_y)) - r31*(cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r22*w_x - r12*w_y) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r23*w_x - r13*w_y) + d_z*cos(orth2)*sin(orth3)*sin(orth4)) + d_y*(r22*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r23*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r21*cos(orth2)*sin(orth3)*sin(orth4)) - (r22*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r23*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)))*(r31*w_x - r11*w_z);
    (r11*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r12*cos(orth2)*cos(orth3)*cos(orth4))*(r33*w_x - r13*w_z) - (r11*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r13*cos(orth2)*cos(orth3)*cos(orth4))*(r32*w_x - r12*w_z) - d_y*(r12*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r13*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r11*cos(orth2)*sin(orth3)*sin(orth4)) + (r12*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r13*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)))*(r31*w_x - r11*w_z);
    r11*(cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r22*w_x - r12*w_y) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r23*w_x - r13*w_y) + d_z*cos(orth2)*sin(orth3)*sin(orth4)) - r12*(d_z*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r21*w_x - r11*w_y) - cos(orth2)*cos(orth3)*cos(orth4)*(r23*w_x - r13*w_y)) - r13*(d_z*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r21*w_x - r11*w_y) + cos(orth2)*cos(orth3)*cos(orth4)*(r22*w_x - r12*w_y));
    0;
    sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r22*w_x - r12*w_y) + sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r23*w_x - r13*w_y) - cos(orth2)*sin(orth3)*sin(orth4)*(r21*w_x - r11*w_y);
    sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_x - r12*w_z) + sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_x - r13*w_z) - cos(orth2)*sin(orth3)*sin(orth4)*(r31*w_x - r11*w_z);
    (d_z*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r21*w_x - r11*w_y))*(r33*w_x - r13*w_z) - (d_z*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r21*w_x - r11*w_y))*(r32*w_x - r12*w_z) - d_y*(sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r22*w_x - r12*w_y) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r23*w_x - r13*w_y)) - (cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r22*w_x - r12*w_y) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r23*w_x - r13*w_y))*(r31*w_x - r11*w_z);
    (r31*w_x - r11*w_z)*(d_z*sin(orth2)*sin(orth3)*sin(orth4) + cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r22*w_x - r12*w_y) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r23*w_x - r13*w_y)) - (r32*w_x - r12*w_z)*(d_z*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4) - cos(orth3)*cos(orth4)*sin(orth2)*(r23*w_x - r13*w_y) + cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r21*w_x - r11*w_y)) - (r33*w_x - r13*w_z)*(cos(orth3)*cos(orth4)*sin(orth2)*(r22*w_x - r12*w_y) - d_z*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r21*w_x - r11*w_y)) + d_y*(sin(orth2)*sin(orth3)*sin(orth4)*(r21*w_x - r11*w_y) + cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4)*(r23*w_x - r13*w_y) - cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)*(r22*w_x - r12*w_y));
    (r32*w_x - r12*w_z)*(cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r21*w_x - r11*w_y) - d_z*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + cos(orth2)*cos(orth4)*sin(orth3)*(r23*w_x - r13*w_y)) - (r31*w_x - r11*w_z)*(cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r22*w_x - r12*w_y) - cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r23*w_x - r13*w_y) + d_z*cos(orth2)*cos(orth3)*sin(orth4)) - (r33*w_x - r13*w_z)*(d_z*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r21*w_x - r11*w_y) + cos(orth2)*cos(orth4)*sin(orth3)*(r22*w_x - r12*w_y)) - d_y*(sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r22*w_x - r12*w_y) + sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r23*w_x - r13*w_y) + cos(orth2)*cos(orth3)*sin(orth4)*(r21*w_x - r11*w_y));
    d_y*(cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r22*w_x - r12*w_y) + cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r23*w_x - r13*w_y) - cos(orth2)*cos(orth4)*sin(orth3)*(r21*w_x - r11*w_y)) + (r33*w_x - r13*w_z)*(d_z*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r21*w_x - r11*w_y) - cos(orth2)*cos(orth3)*sin(orth4)*(r22*w_x - r12*w_y)) + (r32*w_x - r12*w_z)*(d_z*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r21*w_x - r11*w_y) + cos(orth2)*cos(orth3)*sin(orth4)*(r23*w_x - r13*w_y)) - (r31*w_x - r11*w_z)*(sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r23*w_x - r13*w_y) - sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r22*w_x - r12*w_y) + d_z*cos(orth2)*cos(orth4)*sin(orth3))];
dl3 = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cos(orth2)*sin(orth3)*sin(orth4)*(r21*w_x - r11*w_y) - sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r23*w_x - r13*w_y) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r22*w_x - r12*w_y);
    0;
    sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_y - r22*w_z) + sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_y - r23*w_z) - cos(orth2)*sin(orth3)*sin(orth4)*(r31*w_y - r21*w_z);
    r21*(r12*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r13*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + tx*cos(orth2)*sin(orth3)*sin(orth4)) - r22*(r11*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tx*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r13*cos(orth2)*cos(orth3)*cos(orth4)) - r23*(tx*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r11*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r12*cos(orth2)*cos(orth3)*cos(orth4));
    r31*(r32*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r33*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))) + r33*(r31*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r32*cos(orth2)*cos(orth3)*cos(orth4)) - r32*(r31*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r33*cos(orth2)*cos(orth3)*cos(orth4)) + r13*(tx*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r11*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r12*cos(orth2)*cos(orth3)*cos(orth4)) + r12*(r11*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tx*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r13*cos(orth2)*cos(orth3)*cos(orth4)) - r11*(r12*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r13*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + tx*cos(orth2)*sin(orth3)*sin(orth4)) + tz*(r32*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r33*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r31*cos(orth2)*sin(orth3)*sin(orth4));
    r32*(r21*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r23*cos(orth2)*cos(orth3)*cos(orth4)) - r33*(r21*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r22*cos(orth2)*cos(orth3)*cos(orth4)) - r31*(r22*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r23*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))) - tz*(r22*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r23*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r21*cos(orth2)*sin(orth3)*sin(orth4));
    r31*cos(orth2)*sin(orth3)*sin(orth4) - r33*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r32*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3));
    0;
    r12*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r13*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r11*cos(orth2)*sin(orth3)*sin(orth4);
    r31*(cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r32*w_y - r22*w_z) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r33*w_y - r23*w_z)) - d_z*(r12*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r13*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))) - tz*(sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r32*w_y - r22*w_z) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r33*w_y - r23*w_z)) + (r12*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r13*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)))*(r21*w_x - r11*w_y) + r32*(d_x*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_y - r21*w_z)) - r33*(d_x*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_y - r21*w_z)) - (r11*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - tx*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)))*(r22*w_x - r12*w_y) - (r11*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tx*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)))*(r23*w_x - r13*w_y);
    d_z*(r11*sin(orth2)*sin(orth3)*sin(orth4) + r13*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) - r12*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) - (r21*w_x - r11*w_y)*(tx*sin(orth2)*sin(orth3)*sin(orth4) + r12*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) + r13*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)) + (r22*w_x - r12*w_y)*(r11*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) - r13*cos(orth3)*cos(orth4)*sin(orth2) + tx*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) + (r23*w_x - r13*w_y)*(r12*cos(orth3)*cos(orth4)*sin(orth2) + r11*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1) - tx*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4)) + tz*(sin(orth2)*sin(orth3)*sin(orth4)*(r31*w_y - r21*w_z) + cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4)*(r33*w_y - r23*w_z) - cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)*(r32*w_y - r22*w_z)) + r33*(cos(orth3)*cos(orth4)*sin(orth2)*(r32*w_y - r22*w_z) - d_x*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r31*w_y - r21*w_z)) - r31*(d_x*sin(orth2)*sin(orth3)*sin(orth4) + cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r32*w_y - r22*w_z) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r33*w_y - r23*w_z)) + r32*(d_x*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4) - cos(orth3)*cos(orth4)*sin(orth2)*(r33*w_y - r23*w_z) + cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r31*w_y - r21*w_z));
    (r21*w_x - r11*w_y)*(r12*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r13*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + tx*cos(orth2)*cos(orth3)*sin(orth4)) - (r22*w_x - r12*w_y)*(r11*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - tx*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r13*cos(orth2)*cos(orth4)*sin(orth3)) + (r23*w_x - r13*w_y)*(r11*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + tx*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r12*cos(orth2)*cos(orth4)*sin(orth3)) - tz*(sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r32*w_y - r22*w_z) + sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r33*w_y - r23*w_z) + cos(orth2)*cos(orth3)*sin(orth4)*(r31*w_y - r21*w_z)) + r31*(cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r32*w_y - r22*w_z) - cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r33*w_y - r23*w_z) + d_x*cos(orth2)*cos(orth3)*sin(orth4)) - r32*(cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r31*w_y - r21*w_z) - d_x*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + cos(orth2)*cos(orth4)*sin(orth3)*(r33*w_y - r23*w_z)) + r33*(d_x*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r31*w_y - r21*w_z) + cos(orth2)*cos(orth4)*sin(orth3)*(r32*w_y - r22*w_z)) - d_z*(r12*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r13*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r11*cos(orth2)*cos(orth3)*sin(orth4));
    tz*(cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_y - r22*w_z) + cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_y - r23*w_z) - cos(orth2)*cos(orth4)*sin(orth3)*(r31*w_y - r21*w_z)) - (r23*w_x - r13*w_y)*(tx*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + r11*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r12*cos(orth2)*cos(orth3)*sin(orth4)) - (r22*w_x - r12*w_y)*(tx*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r11*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r13*cos(orth2)*cos(orth3)*sin(orth4)) + (r21*w_x - r11*w_y)*(r13*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r12*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tx*cos(orth2)*cos(orth4)*sin(orth3)) + d_z*(r12*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r13*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r11*cos(orth2)*cos(orth4)*sin(orth3)) - r33*(d_x*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_y - r21*w_z) - cos(orth2)*cos(orth3)*sin(orth4)*(r32*w_y - r22*w_z)) - r32*(d_x*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_y - r21*w_z) + cos(orth2)*cos(orth3)*sin(orth4)*(r33*w_y - r23*w_z)) + r31*(sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r33*w_y - r23*w_z) - sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r32*w_y - r22*w_z) + d_x*cos(orth2)*cos(orth4)*sin(orth3))];
dl4 = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0;
    0;
    0;
    (r31*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r33*cos(orth2)*cos(orth3)*cos(orth4))*(r32*w_y - r22*w_z) - (r31*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r32*cos(orth2)*cos(orth3)*cos(orth4))*(r33*w_y - r23*w_z) - d_x*(r32*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r33*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r31*cos(orth2)*sin(orth3)*sin(orth4)) - (r32*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r33*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)))*(r31*w_y - r21*w_z);
    r31*(cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r33*w_x - r13*w_z) - cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r32*w_x - r12*w_z) + d_y*cos(orth2)*sin(orth3)*sin(orth4)) - r32*(d_y*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_x - r11*w_z) + cos(orth2)*cos(orth3)*cos(orth4)*(r33*w_x - r13*w_z)) - r33*(d_y*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_x - r11*w_z) - cos(orth2)*cos(orth3)*cos(orth4)*(r32*w_x - r12*w_z));
    (r11*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r12*cos(orth2)*cos(orth3)*cos(orth4))*(r33*w_y - r23*w_z) - (r11*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r13*cos(orth2)*cos(orth3)*cos(orth4))*(r32*w_y - r22*w_z) + r23*(d_y*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_x - r11*w_z) - cos(orth2)*cos(orth3)*cos(orth4)*(r32*w_x - r12*w_z)) + r22*(d_y*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_x - r11*w_z) + cos(orth2)*cos(orth3)*cos(orth4)*(r33*w_x - r13*w_z)) - r21*(cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r33*w_x - r13*w_z) - cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r32*w_x - r12*w_z) + d_y*cos(orth2)*sin(orth3)*sin(orth4)) + d_x*(r12*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r13*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r11*cos(orth2)*sin(orth3)*sin(orth4)) + (r12*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r13*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)))*(r31*w_y - r21*w_z);
    cos(orth2)*sin(orth3)*sin(orth4)*(r31*w_x - r11*w_z) - sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_x - r13*w_z) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_x - r12*w_z);
    cos(orth2)*sin(orth3)*sin(orth4)*(r31*w_y - r21*w_z) - sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_y - r23*w_z) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_y - r22*w_z);
    0;
    (d_y*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_x - r11*w_z))*(r32*w_y - r22*w_z) - (d_y*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_x - r11*w_z))*(r33*w_y - r23*w_z) + d_x*(sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r32*w_x - r12*w_z) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r33*w_x - r13*w_z)) - (cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r32*w_x - r12*w_z) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r33*w_x - r13*w_z))*(r31*w_y - r21*w_z);
    (r31*w_y - r21*w_z)*(cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r32*w_x - r12*w_z) - d_y*sin(orth2)*sin(orth3)*sin(orth4) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r33*w_x - r13*w_z)) - (r33*w_y - r23*w_z)*(cos(orth3)*cos(orth4)*sin(orth2)*(r32*w_x - r12*w_z) + d_y*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r31*w_x - r11*w_z)) + (r32*w_y - r22*w_z)*(cos(orth3)*cos(orth4)*sin(orth2)*(r33*w_x - r13*w_z) + d_y*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4) - cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r31*w_x - r11*w_z)) - d_x*(sin(orth2)*sin(orth3)*sin(orth4)*(r31*w_x - r11*w_z) + cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4)*(r33*w_x - r13*w_z) - cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)*(r32*w_x - r12*w_z));
    (r31*w_y - r21*w_z)*(cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r33*w_x - r13*w_z) - cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r32*w_x - r12*w_z) + d_y*cos(orth2)*cos(orth3)*sin(orth4)) + (r32*w_y - r22*w_z)*(d_y*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r31*w_x - r11*w_z) + cos(orth2)*cos(orth4)*sin(orth3)*(r33*w_x - r13*w_z)) - (r33*w_y - r23*w_z)*(cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r31*w_x - r11*w_z) - d_y*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + cos(orth2)*cos(orth4)*sin(orth3)*(r32*w_x - r12*w_z)) + d_x*(sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r32*w_x - r12*w_z) + sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r33*w_x - r13*w_z) + cos(orth2)*cos(orth3)*sin(orth4)*(r31*w_x - r11*w_z));
    (r31*w_y - r21*w_z)*(sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r32*w_x - r12*w_z) - sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r33*w_x - r13*w_z) + d_y*cos(orth2)*cos(orth4)*sin(orth3)) - (r33*w_y - r23*w_z)*(d_y*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_x - r11*w_z) + cos(orth2)*cos(orth3)*sin(orth4)*(r32*w_x - r12*w_z)) - (r32*w_y - r22*w_z)*(d_y*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_x - r11*w_z) - cos(orth2)*cos(orth3)*sin(orth4)*(r33*w_x - r13*w_z)) - d_x*(cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_x - r12*w_z) + cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_x - r13*w_z) - cos(orth2)*cos(orth4)*sin(orth3)*(r31*w_x - r11*w_z))];
dl5=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0;
    sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r22*w_x - r12*w_y) + sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r23*w_x - r13*w_y) - cos(orth2)*sin(orth3)*sin(orth4)*(r21*w_x - r11*w_y);
    sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_x - r12*w_z) + sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_x - r13*w_z) - cos(orth2)*sin(orth3)*sin(orth4)*(r31*w_x - r11*w_z);
    r21*(r22*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r23*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))) + r23*(r21*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r22*cos(orth2)*cos(orth3)*cos(orth4)) - r22*(r21*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r23*cos(orth2)*cos(orth3)*cos(orth4)) + r33*(tz*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r31*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r32*cos(orth2)*cos(orth3)*cos(orth4)) + r32*(r31*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tz*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r33*cos(orth2)*cos(orth3)*cos(orth4)) - r31*(r32*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r33*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + tz*cos(orth2)*sin(orth3)*sin(orth4)) + ty*(r22*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r23*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r21*cos(orth2)*sin(orth3)*sin(orth4));
    r22*(r11*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r13*cos(orth2)*cos(orth3)*cos(orth4)) - r23*(r11*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r12*cos(orth2)*cos(orth3)*cos(orth4)) - r21*(r12*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r13*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))) - ty*(r12*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r13*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r11*cos(orth2)*sin(orth3)*sin(orth4));
    r11*(r32*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r33*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + tz*cos(orth2)*sin(orth3)*sin(orth4)) - r12*(r31*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tz*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r33*cos(orth2)*cos(orth3)*cos(orth4)) - r13*(tz*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r31*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r32*cos(orth2)*cos(orth3)*cos(orth4));
    0;
    r32*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r33*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r31*cos(orth2)*sin(orth3)*sin(orth4);
    r21*cos(orth2)*sin(orth3)*sin(orth4) - r23*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r22*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3));
    r21*(cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r22*w_x - r12*w_y) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r23*w_x - r13*w_y)) - d_y*(r32*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r33*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))) - ty*(sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r22*w_x - r12*w_y) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r23*w_x - r13*w_y)) - (r32*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r33*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)))*(r31*w_x - r11*w_z) + r22*(d_z*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r21*w_x - r11*w_y)) - r23*(d_z*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r21*w_x - r11*w_y)) + (r31*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - tz*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)))*(r32*w_x - r12*w_z) + (r31*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tz*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)))*(r33*w_x - r13*w_z);
    d_y*(r31*sin(orth2)*sin(orth3)*sin(orth4) + r33*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) - r32*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) + (r31*w_x - r11*w_z)*(tz*sin(orth2)*sin(orth3)*sin(orth4) + r32*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) + r33*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)) - (r32*w_x - r12*w_z)*(r31*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) - r33*cos(orth3)*cos(orth4)*sin(orth2) + tz*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) - (r33*w_x - r13*w_z)*(r32*cos(orth3)*cos(orth4)*sin(orth2) + r31*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1) - tz*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4)) + ty*(sin(orth2)*sin(orth3)*sin(orth4)*(r21*w_x - r11*w_y) + cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4)*(r23*w_x - r13*w_y) - cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)*(r22*w_x - r12*w_y)) + r23*(cos(orth3)*cos(orth4)*sin(orth2)*(r22*w_x - r12*w_y) - d_z*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r21*w_x - r11*w_y)) - r21*(d_z*sin(orth2)*sin(orth3)*sin(orth4) + cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r22*w_x - r12*w_y) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r23*w_x - r13*w_y)) + r22*(d_z*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4) - cos(orth3)*cos(orth4)*sin(orth2)*(r23*w_x - r13*w_y) + cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r21*w_x - r11*w_y));
    (r32*w_x - r12*w_z)*(r31*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - tz*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r33*cos(orth2)*cos(orth4)*sin(orth3)) - (r31*w_x - r11*w_z)*(r32*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r33*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + tz*cos(orth2)*cos(orth3)*sin(orth4)) - (r33*w_x - r13*w_z)*(r31*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + tz*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r32*cos(orth2)*cos(orth4)*sin(orth3)) - ty*(sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r22*w_x - r12*w_y) + sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r23*w_x - r13*w_y) + cos(orth2)*cos(orth3)*sin(orth4)*(r21*w_x - r11*w_y)) + r21*(cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r22*w_x - r12*w_y) - cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r23*w_x - r13*w_y) + d_z*cos(orth2)*cos(orth3)*sin(orth4)) - r22*(cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r21*w_x - r11*w_y) - d_z*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + cos(orth2)*cos(orth4)*sin(orth3)*(r23*w_x - r13*w_y)) + r23*(d_z*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r21*w_x - r11*w_y) + cos(orth2)*cos(orth4)*sin(orth3)*(r22*w_x - r12*w_y)) - d_y*(r32*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r33*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r31*cos(orth2)*cos(orth3)*sin(orth4));
    ty*(cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r22*w_x - r12*w_y) + cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r23*w_x - r13*w_y) - cos(orth2)*cos(orth4)*sin(orth3)*(r21*w_x - r11*w_y)) + (r33*w_x - r13*w_z)*(tz*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + r31*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r32*cos(orth2)*cos(orth3)*sin(orth4)) + (r32*w_x - r12*w_z)*(tz*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r31*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r33*cos(orth2)*cos(orth3)*sin(orth4)) - (r31*w_x - r11*w_z)*(r33*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r32*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tz*cos(orth2)*cos(orth4)*sin(orth3)) + d_y*(r32*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r33*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r31*cos(orth2)*cos(orth4)*sin(orth3)) - r23*(d_z*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r21*w_x - r11*w_y) - cos(orth2)*cos(orth3)*sin(orth4)*(r22*w_x - r12*w_y)) - r22*(d_z*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r21*w_x - r11*w_y) + cos(orth2)*cos(orth3)*sin(orth4)*(r23*w_x - r13*w_y)) + r21*(sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r23*w_x - r13*w_y) - sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r22*w_x - r12*w_y) + d_z*cos(orth2)*cos(orth4)*sin(orth3))];
dl6=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 r31*cos(orth2)*sin(orth3)*sin(orth4) - r33*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r32*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3));
    0;
    r12*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r13*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r11*cos(orth2)*sin(orth3)*sin(orth4);
    0;
    0;
    0;
    0;
    0;
    0;
    r31*(r12*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r13*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))) - r32*(r11*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - tx*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))) - r33*(r11*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tx*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))) - tz*(r12*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r13*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)));
    tz*(r11*sin(orth2)*sin(orth3)*sin(orth4) + r13*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) - r12*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) - r31*(tx*sin(orth2)*sin(orth3)*sin(orth4) + r12*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) + r13*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)) + r32*(r11*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) - r13*cos(orth3)*cos(orth4)*sin(orth2) + tx*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) + r33*(r12*cos(orth3)*cos(orth4)*sin(orth2) + r11*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1) - tx*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4));
    r31*(r12*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r13*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + tx*cos(orth2)*cos(orth3)*sin(orth4)) - r32*(r11*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - tx*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r13*cos(orth2)*cos(orth4)*sin(orth3)) + r33*(r11*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + tx*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r12*cos(orth2)*cos(orth4)*sin(orth3)) - tz*(r12*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r13*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r11*cos(orth2)*cos(orth3)*sin(orth4));
    tz*(r12*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r13*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r11*cos(orth2)*cos(orth4)*sin(orth3)) - r33*(tx*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + r11*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r12*cos(orth2)*cos(orth3)*sin(orth4)) - r32*(tx*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r11*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r13*cos(orth2)*cos(orth3)*sin(orth4)) + r31*(r13*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r12*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tx*cos(orth2)*cos(orth4)*sin(orth3))];
dl7=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cos(orth2)*sin(orth3)*sin(orth4)*(r31*w_x - r11*w_z) - sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_x - r13*w_z) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_x - r12*w_z);
    cos(orth2)*sin(orth3)*sin(orth4)*(r31*w_y - r21*w_z) - sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_y - r23*w_z) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_y - r22*w_z);
    0;
    r12*(r31*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r33*cos(orth2)*cos(orth3)*cos(orth4)) - r13*(r31*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r32*cos(orth2)*cos(orth3)*cos(orth4)) - r11*(r32*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r33*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))) - tx*(r32*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r33*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r31*cos(orth2)*sin(orth3)*sin(orth4));
    r31*(r22*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r23*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + ty*cos(orth2)*sin(orth3)*sin(orth4)) - r32*(r21*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + ty*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r23*cos(orth2)*cos(orth3)*cos(orth4)) - r33*(ty*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r21*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r22*cos(orth2)*cos(orth3)*cos(orth4));
    r11*(r12*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r13*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))) + r13*(r11*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r12*cos(orth2)*cos(orth3)*cos(orth4)) - r12*(r11*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r13*cos(orth2)*cos(orth3)*cos(orth4)) + r23*(ty*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r21*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r22*cos(orth2)*cos(orth3)*cos(orth4)) + r22*(r21*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + ty*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r23*cos(orth2)*cos(orth3)*cos(orth4)) - r21*(r22*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) - r23*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + ty*cos(orth2)*sin(orth3)*sin(orth4)) + tx*(r12*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r13*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r11*cos(orth2)*sin(orth3)*sin(orth4));
    r22*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r23*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r21*cos(orth2)*sin(orth3)*sin(orth4);
    r11*cos(orth2)*sin(orth3)*sin(orth4) - r13*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r12*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3));
    0;
    tx*(sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r32*w_x - r12*w_z) - sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r33*w_x - r13*w_z)) - d_x*(r22*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r23*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))) - r11*(cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r32*w_x - r12*w_z) + cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r33*w_x - r13*w_z)) + (r22*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r23*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)))*(r31*w_y - r21*w_z) + r12*(d_y*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_x - r11*w_z)) - r13*(d_y*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_x - r11*w_z)) - (r21*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - ty*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)))*(r32*w_y - r22*w_z) - (r21*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + ty*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)))*(r33*w_y - r23*w_z);
    d_x*(r21*sin(orth2)*sin(orth3)*sin(orth4) + r23*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) - r22*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) - (r31*w_y - r21*w_z)*(ty*sin(orth2)*sin(orth3)*sin(orth4) + r22*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) + r23*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)) + (r32*w_y - r22*w_z)*(r21*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) - r23*cos(orth3)*cos(orth4)*sin(orth2) + ty*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) + (r33*w_y - r23*w_z)*(r22*cos(orth3)*cos(orth4)*sin(orth2) + r21*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1) - ty*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4)) - tx*(sin(orth2)*sin(orth3)*sin(orth4)*(r31*w_x - r11*w_z) + cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4)*(r33*w_x - r13*w_z) - cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)*(r32*w_x - r12*w_z)) - r13*(cos(orth3)*cos(orth4)*sin(orth2)*(r32*w_x - r12*w_z) + d_y*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r31*w_x - r11*w_z)) + r12*(cos(orth3)*cos(orth4)*sin(orth2)*(r33*w_x - r13*w_z) + d_y*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4) - cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r31*w_x - r11*w_z)) + r11*(cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4)*(r32*w_x - r12*w_z) - d_y*sin(orth2)*sin(orth3)*sin(orth4) + cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)*(r33*w_x - r13*w_z));
    (r31*w_y - r21*w_z)*(r22*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r23*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + ty*cos(orth2)*cos(orth3)*sin(orth4)) - (r32*w_y - r22*w_z)*(r21*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - ty*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r23*cos(orth2)*cos(orth4)*sin(orth3)) + (r33*w_y - r23*w_z)*(r21*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + ty*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r22*cos(orth2)*cos(orth4)*sin(orth3)) + tx*(sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r32*w_x - r12*w_z) + sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r33*w_x - r13*w_z) + cos(orth2)*cos(orth3)*sin(orth4)*(r31*w_x - r11*w_z)) + r11*(cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r33*w_x - r13*w_z) - cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r32*w_x - r12*w_z) + d_y*cos(orth2)*cos(orth3)*sin(orth4)) + r12*(d_y*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r31*w_x - r11*w_z) + cos(orth2)*cos(orth4)*sin(orth3)*(r33*w_x - r13*w_z)) - r13*(cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r31*w_x - r11*w_z) - d_y*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + cos(orth2)*cos(orth4)*sin(orth3)*(r32*w_x - r12*w_z)) - d_x*(r22*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r23*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r21*cos(orth2)*cos(orth3)*sin(orth4));
    (r31*w_y - r21*w_z)*(r23*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r22*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + ty*cos(orth2)*cos(orth4)*sin(orth3)) - (r33*w_y - r23*w_z)*(ty*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + r21*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r22*cos(orth2)*cos(orth3)*sin(orth4)) - (r32*w_y - r22*w_z)*(ty*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r21*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r23*cos(orth2)*cos(orth3)*sin(orth4)) - tx*(cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))*(r32*w_x - r12*w_z) + cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))*(r33*w_x - r13*w_z) - cos(orth2)*cos(orth4)*sin(orth3)*(r31*w_x - r11*w_z)) + d_x*(r22*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r23*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r21*cos(orth2)*cos(orth4)*sin(orth3)) - r13*(d_y*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r31*w_x - r11*w_z) + cos(orth2)*cos(orth3)*sin(orth4)*(r32*w_x - r12*w_z)) - r12*(d_y*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r31*w_x - r11*w_z) - cos(orth2)*cos(orth3)*sin(orth4)*(r33*w_x - r13*w_z)) + r11*(sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))*(r32*w_x - r12*w_z) - sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2))*(r33*w_x - r13*w_z) + d_y*cos(orth2)*cos(orth4)*sin(orth3))];
dl8=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0;
    r32*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r33*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r31*cos(orth2)*sin(orth3)*sin(orth4);
    r21*cos(orth2)*sin(orth3)*sin(orth4) - r23*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r22*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3));
    0;
    0;
    0;
    0;
    0;
    0;
    r21*(r32*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r33*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))) - r22*(r31*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - tz*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))) - r23*(r31*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tz*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))) - ty*(r32*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r33*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)));
    ty*(r31*sin(orth2)*sin(orth3)*sin(orth4) + r33*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) - r32*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) - r21*(tz*sin(orth2)*sin(orth3)*sin(orth4) + r32*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) + r33*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)) + r22*(r31*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) - r33*cos(orth3)*cos(orth4)*sin(orth2) + tz*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) + r23*(r32*cos(orth3)*cos(orth4)*sin(orth2) + r31*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1) - tz*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4));
    r21*(r32*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r33*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + tz*cos(orth2)*cos(orth3)*sin(orth4)) - r22*(r31*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - tz*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r33*cos(orth2)*cos(orth4)*sin(orth3)) + r23*(r31*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + tz*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r32*cos(orth2)*cos(orth4)*sin(orth3)) - ty*(r32*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r33*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r31*cos(orth2)*cos(orth3)*sin(orth4));
    ty*(r32*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r33*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r31*cos(orth2)*cos(orth4)*sin(orth3)) - r23*(tz*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + r31*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r32*cos(orth2)*cos(orth3)*sin(orth4)) - r22*(tz*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r31*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r33*cos(orth2)*cos(orth3)*sin(orth4)) + r21*(r33*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r32*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + tz*cos(orth2)*cos(orth4)*sin(orth3))];
dl9=[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 r22*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r23*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r21*cos(orth2)*sin(orth3)*sin(orth4);
    r11*cos(orth2)*sin(orth3)*sin(orth4) - r13*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r12*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3));
    0;
    0;
    0;
    0;
    0;
    0;
    0;
    r11*(r22*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r23*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2))) - r12*(r21*cos(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - ty*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3))) - r13*(r21*cos(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + ty*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3))) - tx*(r22*sin(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r23*sin(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)));
    tx*(r21*sin(orth2)*sin(orth3)*sin(orth4) + r23*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4) - r22*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) - r11*(ty*sin(orth2)*sin(orth3)*sin(orth4) + r22*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) + r23*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1)) + r12*(r21*cos(orth1)*cos(orth2)*cos(orth3)*cos(orth4) - r23*cos(orth3)*cos(orth4)*sin(orth2) + ty*cos(orth2)*sin(orth1)*sin(orth3)*sin(orth4)) + r13*(r22*cos(orth3)*cos(orth4)*sin(orth2) + r21*cos(orth2)*cos(orth3)*cos(orth4)*sin(orth1) - ty*cos(orth1)*cos(orth2)*sin(orth3)*sin(orth4));
    r11*(r22*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r23*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + ty*cos(orth2)*cos(orth3)*sin(orth4)) - r12*(r21*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - ty*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r23*cos(orth2)*cos(orth4)*sin(orth3)) + r13*(r21*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + ty*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r22*cos(orth2)*cos(orth4)*sin(orth3)) - tx*(r22*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) + r23*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r21*cos(orth2)*cos(orth3)*sin(orth4));
    tx*(r22*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) + r23*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) - r21*cos(orth2)*cos(orth4)*sin(orth3)) - r13*(ty*cos(orth4)*(cos(orth3)*sin(orth1) + cos(orth1)*sin(orth2)*sin(orth3)) + r21*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r22*cos(orth2)*cos(orth3)*sin(orth4)) - r12*(ty*cos(orth4)*(cos(orth1)*cos(orth3) - sin(orth1)*sin(orth2)*sin(orth3)) - r21*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + r23*cos(orth2)*cos(orth3)*sin(orth4)) + r11*(r23*sin(orth4)*(cos(orth1)*sin(orth3) + cos(orth3)*sin(orth1)*sin(orth2)) - r22*sin(orth4)*(sin(orth1)*sin(orth3) - cos(orth1)*cos(orth3)*sin(orth2)) + ty*cos(orth2)*cos(orth4)*sin(orth3))];


d_l = [dl1, dl2, dl3, dl4, dl5, dl6, dl7, dl8, dl9];





J2_1 = [(r12*w2 - r22*w1)*(r23*w3 - r33*w2) - (r13*w2 - r23*w1)*(r22*w3 - r32*w2);
    (r13*w2 - r23*w1)*(r21*w3 - r31*w2) - (r11*w2 - r21*w1)*(r23*w3 - r33*w2);
    (r11*w2 - r21*w1)*(r22*w3 - r32*w2) - (r12*w2 - r22*w1)*(r21*w3 - r31*w2);
    d1*(r11*w2 - r21*w1) - d3*(r21*w3 - r31*w2);
    d1*(r12*w2 - r22*w1) - d3*(r22*w3 - r32*w2);
    d1*(r13*w2 - r23*w1) - d3*(r23*w3 - r33*w2)];
J2_11 = J2_1(1); J2_12 = J2_1(2);J2_13 = J2_1(3);J2_14 = J2_1(4);J2_15 = J2_1(5);J2_16 = J2_1(6);


J2_2 = [(r12*w2 - r22*w1)*(r13*w3 - r33*w1) - (r13*w2 - r23*w1)*(r12*w3 - r32*w1);
    (r13*w2 - r23*w1)*(r11*w3 - r31*w1) - (r11*w2 - r21*w1)*(r13*w3 - r33*w1);
    (r11*w2 - r21*w1)*(r12*w3 - r32*w1) - (r12*w2 - r22*w1)*(r11*w3 - r31*w1);
    - d2*(r11*w2 - r21*w1) - d3*(r11*w3 - r31*w1);
    - d2*(r12*w2 - r22*w1) - d3*(r12*w3 - r32*w1);
    - d2*(r13*w2 - r23*w1) - d3*(r13*w3 - r33*w1)];
J2_21 = J2_2(1); J2_22 = J2_2(2);J2_23 = J2_2(3);J2_24 = J2_2(4);J2_25 = J2_2(5);J2_26 = J2_2(6);


J2_3 = [r12*(r13*w2 - r23*w1) - r13*(r12*w2 - r22*w1) + r33*(r22*w3 - r32*w2) - r32*(r23*w3 - r33*w2);
    r13*(r11*w2 - r21*w1) - r11*(r13*w2 - r23*w1) - r33*(r21*w3 - r31*w2) + r31*(r23*w3 - r33*w2);
    r11*(r12*w2 - r22*w1) - r12*(r11*w2 - r21*w1) + r32*(r21*w3 - r31*w2) - r31*(r22*w3 - r32*w2);
    d3*r11 - d1*r31 + t1*(r11*w2 - r21*w1) - t3*(r21*w3 - r31*w2);
    d3*r12 - d1*r32 + t1*(r12*w2 - r22*w1) - t3*(r22*w3 - r32*w2);
    d3*r13 - d1*r33 + t1*(r13*w2 - r23*w1) - t3*(r23*w3 - r33*w2)];
J2_31 = J2_3(1); J2_32 = J2_3(2);J2_33 = J2_3(3);J2_34 = J2_3(4);J2_35 = J2_3(5);J2_36 = J2_3(6);


J2_4 = [(r12*w3 - r32*w1)*(r23*w3 - r33*w2) - (r13*w3 - r33*w1)*(r22*w3 - r32*w2);
    (r13*w3 - r33*w1)*(r21*w3 - r31*w2) - (r11*w3 - r31*w1)*(r23*w3 - r33*w2);
    (r11*w3 - r31*w1)*(r22*w3 - r32*w2) - (r12*w3 - r32*w1)*(r21*w3 - r31*w2);
    d1*(r11*w3 - r31*w1) + d2*(r21*w3 - r31*w2);
    d1*(r12*w3 - r32*w1) + d2*(r22*w3 - r32*w2);
    d1*(r13*w3 - r33*w1) + d2*(r23*w3 - r33*w2)];
J2_41 = J2_4(1); J2_42 = J2_4(2);J2_43 = J2_4(3);J2_44 = J2_4(4);J2_45 = J2_4(5);J2_46 = J2_4(6);


J2_5 = [r23*(r12*w2 - r22*w1) - r22*(r13*w2 - r23*w1) + r33*(r12*w3 - r32*w1) - r32*(r13*w3 - r33*w1);
    r21*(r13*w2 - r23*w1) - r23*(r11*w2 - r21*w1) - r33*(r11*w3 - r31*w1) + r31*(r13*w3 - r33*w1);
    r22*(r11*w2 - r21*w1) - r21*(r12*w2 - r22*w1) + r32*(r11*w3 - r31*w1) - r31*(r12*w3 - r32*w1);
    d2*r31 - d3*r21 - t2*(r11*w2 - r21*w1) - t3*(r11*w3 - r31*w1);
    d2*r32 - d3*r22 - t2*(r12*w2 - r22*w1) - t3*(r12*w3 - r32*w1);
    d2*r33 - d3*r23 - t2*(r13*w2 - r23*w1) - t3*(r13*w3 - r33*w1)];
J2_51 = J2_5(1); J2_52 = J2_5(2);J2_53 = J2_5(3);J2_54 = J2_5(4);J2_55 = J2_5(5);J2_56 = J2_5(6);


J2_6 = [r13*r32 - r12*r33;
    r11*r33 - r13*r31;
    r12*r31 - r11*r32;
    r11*t3 - r31*t1;
    r12*t3 - r32*t1;
    r13*t3 - r33*t1];
J2_61 = J2_6(1); J2_62 = J2_6(2);J2_63 = J2_6(3);J2_64 = J2_6(4);J2_65 = J2_6(5);J2_66 = J2_6(6);


J2_7 = [r12*(r13*w3 - r33*w1) - r13*(r12*w3 - r32*w1) - r23*(r22*w3 - r32*w2) + r22*(r23*w3 - r33*w2);
    r13*(r11*w3 - r31*w1) - r11*(r13*w3 - r33*w1) + r23*(r21*w3 - r31*w2) - r21*(r23*w3 - r33*w2);
    r11*(r12*w3 - r32*w1) - r12*(r11*w3 - r31*w1) - r22*(r21*w3 - r31*w2) + r21*(r22*w3 - r32*w2);
    d1*r21 - d2*r11 + t1*(r11*w3 - r31*w1) + t2*(r21*w3 - r31*w2);
    d1*r22 - d2*r12 + t1*(r12*w3 - r32*w1) + t2*(r22*w3 - r32*w2);
    d1*r23 - d2*r13 + t1*(r13*w3 - r33*w1) + t2*(r23*w3 - r33*w2)];
J2_71 = J2_7(1); J2_72 = J2_7(2);J2_73 = J2_7(3);J2_74 = J2_7(4);J2_75 = J2_7(5);J2_76 = J2_7(6);


J2_8 = [r22*r33 - r23*r32;
    r23*r31 - r21*r33;
    r21*r32 - r22*r31;
    r31*t2 - r21*t3;
    r32*t2 - r22*t3;
    r33*t2 - r23*t3];
J2_81 = J2_8(1); J2_82 = J2_8(2);J2_83 = J2_8(3);J2_84 = J2_8(4);J2_85 = J2_8(5);J2_86 = J2_8(6);

J2_9 = [r12*r23 - r13*r22;
    r13*r21 - r11*r23;
    r11*r22 - r12*r21;
    r21*t1 - r11*t2;
    r22*t1 - r12*t2;
    r23*t1 - r13*t2];
J2_91 = J2_9(1); J2_92 = J2_9(2);J2_93 = J2_9(3);J2_94 = J2_9(4);J2_95 = J2_9(5);J2_96 = J2_9(6);

J2 = [[J2_11, J2_12, J2_13, J2_14, J2_15, J2_16];[J2_21, J2_22, J2_23, J2_24, J2_25, J2_26];[J2_31, J2_32, J2_33, J2_34, J2_35, J2_36];[J2_41, J2_42, J2_43, J2_44, J2_45, J2_46];[J2_51, J2_52, J2_53, J2_54, J2_55, J2_56];[J2_61, J2_62, J2_63, J2_64, J2_65, J2_66];[J2_71, J2_72, J2_73, J2_74, J2_75, J2_76];[J2_81, J2_82, J2_83, J2_84, J2_85, J2_86];[J2_91, J2_92, J2_93, J2_94, J2_95, J2_96]];


A = (I+v*X_(w)); A = A';
b = R * n;
J3_R1 = [[A(3)*b(2) - A(2)*b(3), A(1)*b(3) - A(3)*b(1), A(2)*b(1) - A(1)*b(2)]; [A(6)*b(2) - A(5)*b(3), A(4)*b(3) - A(6)*b(1), A(5)*b(1) - A(4)*b(2)]; [A(9)*b(2) - A(8)*b(3), A(7)*b(3) - A(9)*b(1), A(8)*b(1) - A(7)*b(2)]];

A = X_(T+v*d)*(I+v*X_(w)); A = A';
b = R * a;
J3_R2 = [[A(3)*b(2) - A(2)*b(3), A(1)*b(3) - A(3)*b(1), A(2)*b(1) - A(1)*b(2)]; [A(6)*b(2) - A(5)*b(3), A(4)*b(3) - A(6)*b(1), A(5)*b(1) - A(4)*b(2)]; [A(9)*b(2) - A(8)*b(3), A(7)*b(3) - A(9)*b(1), A(8)*b(1) - A(7)*b(2)]];

A = (I+v*X_(w)); A = A';
b = R * a;
J3_R3 = [[A(3)*b(2) - A(2)*b(3), A(1)*b(3) - A(3)*b(1), A(2)*b(1) - A(1)*b(2)]; [A(6)*b(2) - A(5)*b(3), A(4)*b(3) - A(6)*b(1), A(5)*b(1) - A(4)*b(2)]; [A(9)*b(2) - A(8)*b(3), A(7)*b(3) - A(9)*b(1), A(8)*b(1) - A(7)*b(2)]];

J3_R = [J3_R1+J3_R2; J3_R3];

N_cw = [[(I+v*X_(w))*R, X_(T+v*d)*(I+v*X_(w))*R];[zeros(3), (I+v*X_(w))*R]];
J3 = inv(N_cw)*J3_R;

JR_l = J1_l*J2*J3;
JR_s = J1_s*J2*J3;


J_l = J1_l* d_l';
J_l = [JR_l(1), JR_l(2), JR_l(3), J_l];

J_s = J1_s* d_l';
J_s = [JR_s(1), JR_s(2), JR_s(3), J_s];
end


